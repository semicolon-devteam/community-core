import{jsxs as e,jsx as t}from"react/jsx-runtime";import{forwardRef as n,useState as r,useRef as s,useMemo as a,useEffect as o,useCallback as l}from"react";import{createClient as i}from"@supabase/supabase-js";const c=e=>{if(null==e||""===e)return"";const t=("number"==typeof e?e.toString():e).split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.length>1?t.join("."):t[0]};var d=Object.freeze({__proto__:null,formatNumberWithComma:c,removeCommaFromString:e=>e?parseFloat(e.replace(/,/g,"")):0});function u(e,t=!1){if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return e;const r=n.getFullYear(),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),i=String(n.getSeconds()).padStart(2,"0");return t?`${r}.${s}.${a}`:`${r}.${s}.${a}. ${o}:${l}:${i}`}function m(e,t=!0){if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return e;const r=new Date,s=Math.floor((r.getTime()-n.getTime())/1e3);if(s<60)return"방금 전";const a=Math.floor(s/60);if(a<60)return`${a}분 전`;const o=Math.floor(a/60);return o<24?`${o}시간 전`:t?g.toChar(e,"MM.dd"):g.toChar(e,"yyyy.MM.dd. HH:mm:ss")}const g={toChar(e,t="YYYY.MM.DD. HH:MM:SS"){const n="string"==typeof e?new Date(e):e;if(!n||isNaN(n.getTime()))return"";const r={yyyy:String(n.getFullYear()),MM:String(n.getMonth()+1).padStart(2,"0"),dd:String(n.getDate()).padStart(2,"0"),HH:String(n.getHours()).padStart(2,"0"),mm:String(n.getMinutes()).padStart(2,"0"),ss:String(n.getSeconds()).padStart(2,"0")};return Object.entries(r).reduce((e,[t,n])=>e.replace(t,n),t)}};var p=Object.freeze({__proto__:null,DateUtil:g,formatDate:u,timeAgo:m});function h(e){return e&&"string"==typeof e.sub&&e.user_metadata}function f(e){return e&&"string"==typeof e.id&&e.nickname&&e.permissionType}const b=e=>e.level>=99||"admin"===e.permissionType||"super_admin"===e.permissionType,x=e=>!!e&&b(e),y=(e,t=0)=>{if(!e||"object"==typeof e&&0===Object.keys(e).length)return 0===t;if(x(e))return!0;if(f(e))return e.level>=t;if(h(e)){console.warn("[DEPRECATED] JWT 기반 권한 체크는 권장하지 않습니다. useAppSelector(selectUserInfo)를 사용하여 Redux store의 사용자 정보를 활용하세요.");return(e.is_admin?99:e.level||1)>=t}return e.level>=t};var v=Object.freeze({__proto__:null,checkIsAdmin:b,getUserLevel:e=>e?f(e)?e.level||0:h(e)?(console.warn("[DEPRECATED] JWT 기반 레벨 조회는 권장하지 않습니다. useAppSelector(selectUserInfo)를 사용하여 Redux store의 사용자 정보를 활용하세요."),e.is_admin?99:e.level||1):e.level||0:0,getUserPermissionType:e=>e?e.permissionType||"user":"anonymous",getUserPermissionTypeFromDB:e=>e?e.permissionType||"user":"anonymous",getUserPermissionTypeFromJWT:e=>e?e.permissionType||"user":"anonymous",hasBoardPermission:(e,t=0,n=!1)=>"free"===t||0===t||!(!n||!e)&&y(e,t),hasLevelPermission:y,isAdmin:x,isAdminOrSuperAdmin:e=>!!e&&b(e),isJWTPayload:h,isSuperAdmin:e=>!!e&&b(e),isUserObject:f,isValidUser:e=>!!e&&"string"==typeof e.id&&!!e.nickname&&!!e.permissionType});const N={sm:120,md:240,lg:480,xl:720,xxl:960};function w(e,t="md",n=70){if(!e||!e.includes("/storage/v1/object/"))return e;try{const r=e.replace("/storage/v1/object/","/storage/v1/render/image/"),s="number"==typeof t?t:N[t],a=Math.max(20,Math.min(100,n)),o=r.includes("?")?"&":"?";return`${r}${o}${`width=${s}&quality=${a}`}`}catch(t){return console.error("Failed to transform Supabase image URL:",t),e}}function _(e,t=["sm","md","lg"],n=70){const r={};return t.forEach(t=>{r[t]=w(e,t,n)}),r}function S({src:e,width:t,quality:n}){return`https://community.semi-colon.space/storage/v1/render/image/public/${e}?width=${t}&quality=${n||75}`}function $(e){if(!e||"string"!=typeof e)return e;try{const t=process.env.NEXT_PUBLIC_STORAGE_URL;if(t&&e.startsWith(t)){const n=e.replace(t,"");return n.startsWith("/")?n:`/${n}`}return e}catch(t){return console.error("Failed to normalize image src:",t),e}}function E(e,t,n){const r=$(e);return void 0!==t&&r.includes("/storage/v1/object/")?w(r,t,n):r}function T(e){if(!e||"string"!=typeof e)return!1;const t=e.toLowerCase();return t.endsWith(".gif")||t.includes(".gif?")}var C=Object.freeze({__proto__:null,IMAGE_SIZE:N,generateImageSrcSet:_,getImageProps:function(e){return T(e)?{unoptimized:!0}:{}},isAnimatedImage:function(e){return!(!e||"string"!=typeof e)&&(e.toLowerCase(),T(e))},isGifImage:T,normalizeImageSrc:$,optimizeImageSrc:E,supabaseImageLoader:S,transformSupabaseImageUrl:w});class k{static calculateUserLevel(e,t){if(!t.length)return 0;const n=[...t].sort((e,t)=>e.level-t.level);let r=0;for(const t of n){if(!(e>=t.required_points))break;r=t.level}return r}static getLevelProgress(e,t){if(!t.length)return{currentLevel:0,currentLevelPoints:0,nextLevel:1,nextLevelPoints:0,progressPercentage:0,pointsToNext:0};const n=[...t].sort((e,t)=>e.level-t.level),r=this.calculateUserLevel(e,t),s=n.find(e=>e.level===r),a=s?.required_points||0,o=n.find(e=>e.level===r+1),l=o?.level||r,i=o?.required_points||a;let c=0,d=0;if(o){const t=i-a,n=e-a;c=t>0?Math.min(100,n/t*100):100,d=Math.max(0,i-e)}else c=100,d=0;return{currentLevel:r,currentLevelPoints:a,nextLevel:l,nextLevelPoints:i,progressPercentage:Math.round(c),pointsToNext:d}}static getNextLevelInfo(e,t){if(!t.length)return{nextLevel:1,requiredPoint:0,levelUpPercentage:0,isMaxLevel:!0};const n=[...t].sort((e,t)=>e.level-t.level),r=this.calculateUserLevel(e,t),s=n.find(e=>e.level===r),a=s?.required_points||0,o=n.find(e=>e.level===r+1);if(!o)return{nextLevel:r,requiredPoint:0,levelUpPercent:100,isMaxLevel:!0};const l=o.level,i=o.required_points,c=i-a,d=e-a;return{nextLevel:l,requiredPoint:Math.max(0,i-e),levelUpPercent:c>0?Math.min(100,Math.round(d/c*100)):100,isMaxLevel:!1}}}var U=Object.freeze({__proto__:null,LevelUtil:k});const O=e=>e.replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),I=e=>e.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`),R=e=>{if(null==e)return e;if(Array.isArray(e))return e.map(e=>"object"==typeof e&&null!==e?R(e):e);if("object"==typeof e){const t={};for(const[n,r]of Object.entries(e)){const e=O(n);"object"!=typeof r||null===r||Array.isArray(r)?Array.isArray(r)?t[e]=r.map(e=>"object"==typeof e&&null!==e?R(e):e):t[e]=r:t[e]=R(r)}return t}return e},L=e=>{if(null==e)return e;if(Array.isArray(e))return e.map(e=>"object"==typeof e&&null!==e?L(e):e);if("object"==typeof e){const t={};for(const[n,r]of Object.entries(e)){const e=I(n);"object"!=typeof r||null===r||Array.isArray(r)?Array.isArray(r)?t[e]=r.map(e=>"object"==typeof e&&null!==e?L(e):e):t[e]=r:t[e]=L(r)}return t}return e};var A=Object.freeze({__proto__:null,keysToCamelCase:R,keysToSnakeCase:L,toCamelCase:O,toSnakeCase:I});const P=(e,t)=>{try{const n=e.startsWith("http")?new URL(e):new URL(e,window.location.origin),r=new URLSearchParams(n.search);return Object.entries(t).forEach(([e,t])=>{r.set(e,t)}),`${n.pathname}?${r.toString()}`}catch(e){throw console.error("URL 파싱 오류:",e),new Error("유효하지 않은 URL입니다.")}},D=(e,t,n="/")=>{const r=sessionStorage.getItem(e);if(!r)return n;try{return P(r,t)}catch(e){return console.error("이전 URL 처리 오류:",e),n}};var M=Object.freeze({__proto__:null,addUrlParams:P,getPreviousUrlWithParams:D});function j(e){try{const t=e.split(".");if(3!==t.length)return console.error("Invalid JWT format"),null;const n=function(e){for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4;)e+="=";return decodeURIComponent(atob(e).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))}(t[1]);return JSON.parse(n)}catch(e){return console.error("JWT 디코딩 실패:",e),null}}async function z(){try{const{clientSupabase:e}=await Promise.resolve().then(function(){return ue}),{data:{session:t}}=await e.auth.getSession();return t?.access_token?j(t.access_token):null}catch(e){return console.error("토큰에서 사용자 정보 추출 실패:",e),null}}function F(e){const t=Math.floor(Date.now()/1e3);return e.exp<=t}function W(e){const t=Math.floor(Date.now()/1e3);return e.exp-t}function B(e="sb-access-token"){if("undefined"!=typeof window)try{const t=document.cookie.split("; ").find(t=>t.startsWith(`${e}=`))?.split("=")[1];if(!t)return;const n=decodeURIComponent(t),r=JSON.parse(n),s=r?.access_token;if(!s)return;const a=j(s);if(a&&F(a)){console.log("🗑️ 만료된 토큰 감지, 쿠키에서 제거 중..."),document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Lax`;["supabase-auth-token","sb-auth-token","auth-token"].forEach(e=>{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Lax`}),console.log("✅ 만료된 토큰 쿠키 제거 완료")}}catch(e){console.error("❌ 만료된 토큰 제거 중 오류:",e)}}async function q(){try{const{clientSupabase:e}=await Promise.resolve().then(function(){return ue}),{data:{session:t}}=await e.auth.getSession();if(!t?.access_token)return B(),null;const n=j(t.access_token);return n?F(n)?(B(),await e.auth.signOut(),null):n:(B(),null)}catch(e){return console.error("토큰 검증 및 정리 실패:",e),B(),null}}function H(e){return W(e)<=300}var J,G=Object.freeze({__proto__:null,decodeJWTPayload:j,getCurrentUserFromToken:z,getTokenTimeToExpiry:W,isTokenExpired:F,removeExpiredTokenFromCookie:B,shouldRefreshToken:H,validateAndCleanToken:q});!function(e){e.NETWORK_ERROR="network_error",e.FILE_TOO_LARGE="file_too_large",e.UNSUPPORTED_FORMAT="unsupported_format",e.PERMISSION_DENIED="permission_denied",e.SERVER_ERROR="server_error",e.UPLOAD_TIMEOUT="upload_timeout",e.QUOTA_EXCEEDED="quota_exceeded",e.INVALID_POST="invalid_post"}(J||(J={}));const V={[J.FILE_TOO_LARGE]:"파일 크기가 너무 큽니다. 이미지는 10MB, 비디오는 100MB 이하로 업로드해주세요.",[J.UNSUPPORTED_FORMAT]:"지원하지 않는 파일 형식입니다. JPG, PNG, GIF, WebP, MP4, AVI, MOV 파일만 업로드 가능합니다.",[J.PERMISSION_DENIED]:"파일 업로드 권한이 없습니다. 로그인 상태를 확인해주세요.",[J.NETWORK_ERROR]:"네트워크 오류가 발생했습니다. 인터넷 연결을 확인하고 다시 시도해주세요.",[J.SERVER_ERROR]:"서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.",[J.UPLOAD_TIMEOUT]:"업로드 시간이 초과되었습니다. 파일 크기를 확인하거나 다시 시도해주세요.",[J.QUOTA_EXCEEDED]:"업로드 할당량을 초과했습니다. 불필요한 파일을 삭제하거나 관리자에게 문의하세요.",[J.INVALID_POST]:"유효하지 않은 게시글입니다. 게시글을 다시 생성해주세요."};var K=Object.freeze({__proto__:null,AuthUtils:v,DateUtil:g,DateUtils:p,IMAGE_SIZE:N,ImageUtils:C,JwtUtils:G,LevelUtil:k,LevelUtils:U,NumberUtils:d,StringUtils:A,get UploadErrorType(){return J},UrlUtils:M,addUrlParams:P,calculateUploadMetrics:function(e,t){return{startTime:t,totalFiles:e.length,completedFiles:e.filter(e=>"completed"===e.status).length,failedFiles:e.filter(e=>"failed"===e.status).length,totalBytes:e.reduce((e,t)=>e+(t.fileSize||0),0),uploadedBytes:e.reduce((e,t)=>e+(t.fileSize||0)*((t.progress||0)/100),0),retryCount:0}},calculateUploadSpeed:function(e){const t=(Date.now()-e.startTime)/1e3,n=e.uploadedBytes/1048576;return t>0?n/t:0},decodeJWTPayload:j,estimateCompletionTime:function(e){const t=Date.now()-e.startTime,n=e.uploadedBytes/e.totalBytes;if(0===n)return null;const r=t/n-t;return Math.max(0,r)},formatDate:u,formatNumberWithComma:c,generateImageSrcSet:_,getCurrentUserFromToken:z,getPreviousUrlWithParams:D,getTokenTimeToExpiry:W,getUploadErrorMessage:function(e){const t=e?.message?.toLowerCase()||"",n=e?.response?.data;if(n?.error?.code){const e=n.error.code;if(V[e])return V[e]}return t.includes("file too large")||t.includes("413")?V[J.FILE_TOO_LARGE]:t.includes("unsupported")||t.includes("invalid format")||t.includes("415")?V[J.UNSUPPORTED_FORMAT]:t.includes("permission")||t.includes("unauthorized")||t.includes("401")||t.includes("403")?V[J.PERMISSION_DENIED]:t.includes("network")||t.includes("fetch")||t.includes("timeout")||"NETWORK_ERROR"===e?.code?V[J.NETWORK_ERROR]:t.includes("quota")||t.includes("storage full")||t.includes("429")?V[J.QUOTA_EXCEEDED]:t.includes("post not found")||t.includes("invalid post")||t.includes("404")?V[J.INVALID_POST]:"파일 업로드 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요."},isAdmin:x,isRetryableError:function(e){const t=e?.message?.toLowerCase()||"",n=e?.response?.data?.error?.code;return![J.FILE_TOO_LARGE,J.UNSUPPORTED_FORMAT,J.PERMISSION_DENIED,J.QUOTA_EXCEEDED,J.INVALID_POST].includes(n)&&!(t.includes("file too large")||t.includes("unsupported")||t.includes("invalid format")||t.includes("permission")||t.includes("unauthorized")||t.includes("quota"))},isTokenExpired:F,keysToCamelCase:R,keysToSnakeCase:L,logUploadError:function(e,t){const n={message:e?.message||"Unknown error",stack:e?.stack,response:e?.response?.data,context:t,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent};"development"===process.env.NODE_ENV&&(console.group("🚨 Upload Error"),console.error("Error Details:",n),console.groupEnd()),"production"===process.env.NODE_ENV&&console.error("Upload Error:",n)},normalizeImageSrc:$,optimizeImageSrc:E,removeExpiredTokenFromCookie:B,shouldRefreshToken:H,supabaseImageLoader:S,timeAgo:m,toCamelCase:O,toSnakeCase:I,transformSupabaseImageUrl:w,validateAndCleanToken:q});let X={};function Y(e){X={...X,...e},e.development&&console.log("🚀 @semicolon/community-core initialized with config:",X)}function Q(){return Object.freeze({...X})}const Z=n(({variant:n="primary",size:r="md",loading:s=!1,fullWidth:a=!1,startIcon:o,endIcon:l,disabled:i,className:c="",children:d,...u},m)=>{const g=["inline-flex items-center justify-center font-medium transition-colors","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[n],{sm:"px-3 py-1.5 text-sm rounded-md",md:"px-4 py-2 text-base rounded-lg",lg:"px-6 py-3 text-lg rounded-lg"}[r],a?"w-full":"",c].filter(Boolean).join(" ");return e("button",{ref:m,className:g,disabled:i||s,...u,children:[s&&t(()=>e("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[t("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),{}),!s&&o&&t("span",{className:"mr-2",children:o}),d,!s&&l&&t("span",{className:"ml-2",children:l})]})});Z.displayName="Button";const ee=({variant:n="primary",size:r="md",rounded:s=!1,dot:a=!1,className:o="",children:l,...i})=>{const c={primary:"bg-blue-400",secondary:"bg-gray-400",success:"bg-green-400",warning:"bg-yellow-400",danger:"bg-red-400",info:"bg-indigo-400"},d=[...["inline-flex items-center font-medium",s?"rounded-full":"rounded-md"],{primary:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-indigo-100 text-indigo-800"}[n],{sm:"px-2 py-1 text-xs",md:"px-2.5 py-1.5 text-sm",lg:"px-3 py-2 text-base"}[r],o].filter(Boolean).join(" ");return e("span",{className:d,...i,children:[a&&t(()=>t("span",{className:`w-2 h-2 rounded-full mr-1.5 ${c[n]}`,"aria-hidden":"true"}),{}),l]})},te=({src:n,name:s="",size:a="md",status:o,square:l=!1,className:i="",alt:c,...d})=>{const[u,m]=r(!1),[g,p]=r(!1),h=["inline-block relative",l?"rounded-lg":"rounded-full","bg-gray-100 overflow-hidden","ring-2 ring-white",{xs:"w-6 h-6 text-xs",sm:"w-8 h-8 text-sm",md:"w-10 h-10 text-base",lg:"w-12 h-12 text-lg",xl:"w-14 h-14 text-xl","2xl":"w-16 h-16 text-2xl"}[a]],f=n?$(n):void 0,b=[...h,i].filter(Boolean).join(" ");return e("div",{className:b,children:[f&&!u?t("img",{src:f,alt:c||s,className:"w-full h-full object-cover",onError:()=>{m(!0)},onLoad:()=>{p(!0)},...d}):t("div",{className:"w-full h-full flex items-center justify-center bg-gray-300 text-gray-600 font-medium",children:(e=>e.split(" ").map(e=>e.charAt(0).toUpperCase()).join("").slice(0,2))(s)||"?"}),o&&t("span",{className:`absolute bottom-0 right-0 block ${{xs:"w-1.5 h-1.5",sm:"w-2 h-2",md:"w-2.5 h-2.5",lg:"w-3 h-3",xl:"w-3.5 h-3.5","2xl":"w-4 h-4"}[a]} ${{online:"bg-green-400",offline:"bg-gray-400",away:"bg-yellow-400",busy:"bg-red-400"}[o]} rounded-full ring-2 ring-white`,title:`Status: ${o}`,"aria-label":`User status: ${o}`})]})},ne=n(({label:n,error:r,helper:s,type:a="text",size:o="md",fullWidth:l=!1,startAdornment:i,endAdornment:c,className:d="",containerClassName:u="",labelClassName:m="",errorClassName:g="",helperClassName:p="",disabled:h=!1,required:f=!1,id:b,...x},y)=>{const v=b||`input-${Math.random().toString(36).substr(2,9)}`,N=`\n    \n    w-full\n    font-sans\n    text-gray-900\n    bg-white\n    border\n    rounded-lg\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n  \n    ${{sm:"h-8 px-2 text-sm",md:"h-10 px-3 text-sm",lg:"h-12 px-4 text-base"}[o]}\n    ${r?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500 hover:border-gray-400"}\n    ${i?"pl-8":""}\n    ${c?"pr-8":""}\n    ${d}\n  `.trim().replace(/\s+/g," ");return e("div",{className:`${l?"w-full":"w-auto"} ${u}`,children:[n&&t("label",{htmlFor:v,className:`\n            block\n            text-sm\n            font-medium\n            text-gray-700\n            mb-2\n            font-sans\n            ${f?"after:content-['*'] after:text-red-500 after:ml-1":""}\n            ${h?"opacity-50":""}\n            ${m}\n          `.trim().replace(/\s+/g," "),children:n}),e("div",{className:"relative",children:[i&&t("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:i}),t("input",{ref:y,id:v,type:a,disabled:h,required:f,className:N,...x}),c&&t("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:c})]}),r&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${g}\n        `.trim().replace(/\s+/g," "),children:r}),s&&!r&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${p}\n        `.trim().replace(/\s+/g," "),children:s})]})});ne.displayName="Input";const re=n(({options:n,value:l,onChange:i,placeholder:c="선택해주세요",disabled:d=!1,label:u,error:m,helper:g,size:p="md",fullWidth:h=!0,multiple:f=!1,searchable:b=!1,searchPlaceholder:x="검색...",showIcon:y=!1,showDescription:v=!1,maxHeight:N="240px",noOptionsText:w="옵션이 없습니다",className:_="",dropdownClassName:S="",labelClassName:$="",errorClassName:E="",helperClassName:T=""},C)=>{const[k,U]=r(!1),[O,I]=r(""),R=s(null),L=`select-${Math.random().toString(36).substr(2,9)}`,A=a(()=>f?null:n.find(e=>e.value===l),[n,l,f]);o(()=>{const e=e=>{R.current&&!R.current.contains(e.target)&&(U(!1),I(""))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const P=`\n    \n    w-full\n    font-sans\n    bg-white\n    border\n    rounded-lg\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n    flex\n    items-center\n    justify-between\n    cursor-pointer\n  \n    ${{sm:"h-8 px-2 text-sm",md:"h-10 px-3 text-sm",lg:"h-12 px-4 text-base"}[p]}\n    ${m?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500 hover:border-gray-400"}\n    ${_}\n  `.trim().replace(/\s+/g," ");return e("div",{ref:C,className:(h?"w-full":"w-auto")+" relative",children:[u&&t("label",{htmlFor:L,className:`\n            block\n            text-sm\n            font-medium\n            text-gray-700\n            mb-2\n            font-sans\n            ${d?"opacity-50":""}\n            ${$}\n          `.trim().replace(/\s+/g," "),children:u}),e("div",{ref:R,id:L,role:"button",tabIndex:d?-1:0,"aria-expanded":k,"aria-haspopup":"listbox",onClick:()=>{d||(U(!k),I(""))},className:P,children:[t("div",{className:"flex items-center gap-2 flex-1 overflow-hidden",children:t("span",A?{className:"truncate text-gray-900",children:A.label}:{className:"text-gray-500 truncate",children:c})}),t("svg",{className:"w-4 h-4 text-gray-400 transition-transform duration-200 flex-shrink-0 "+(k?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k&&t("div",{className:`absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 overflow-hidden ${S}`,children:t("div",{className:"overflow-y-auto",style:{maxHeight:N},role:"listbox",children:0===n.length?t("div",{className:"px-3 py-8 text-center text-gray-500 text-sm",children:w}):n.map(n=>{const r=n.value===l;return t("button",{type:"button",role:"option","aria-selected":r,onClick:()=>(e=>{e.disabled||(i(e),f||(U(!1),I("")))})(n),disabled:n.disabled,className:`\n                      w-full px-3 py-2 text-left flex items-center gap-2 text-sm cursor-pointer\n                      transition-colors duration-150\n                      ${n.disabled?"opacity-50 cursor-not-allowed bg-gray-50":r?"bg-blue-50 text-blue-600":"hover:bg-gray-100 text-gray-900"}\n                      border-b border-gray-100 last:border-b-0\n                    `.trim().replace(/\s+/g," "),children:e("div",{className:"flex-1 min-w-0",children:[t("div",{className:"truncate",children:n.label}),v&&n.description&&t("div",{className:"text-xs text-gray-500 mt-1 truncate",children:n.description})]})},n.id)})})}),m&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${E}\n        `.trim().replace(/\s+/g," "),children:m}),g&&!m&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${T}\n        `.trim().replace(/\s+/g," "),children:g})]})});re.displayName="Select";const se=n(({checked:n=!1,onChange:r,label:s,error:a,helper:o,size:l="md",indeterminate:i=!1,labelPosition:c="right",disabled:d=!1,className:u="",containerClassName:m="",labelClassName:g="",errorClassName:p="",helperClassName:h="",id:f,...b},x)=>{const y=f||`checkbox-${Math.random().toString(36).substr(2,9)}`,v=`\n    \n    text-blue-600\n    bg-white\n    border-2\n    rounded\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    focus:border-blue-500\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n  \n    ${{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"}[l]}\n    ${a?"border-red-500":"border-gray-300 hover:border-blue-500"}\n    ${u}\n  `.trim().replace(/\s+/g," "),N=t("input",{ref:x,id:y,type:"checkbox",checked:n,onChange:e=>{r?.(e.target.checked,e)},disabled:d,className:v,...b}),w=s&&t("label",{htmlFor:y,className:`\n        text-gray-700\n        text-xs sm:text-sm\n        font-normal\n        font-sans\n        select-none\n        ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n        ${g}\n      `.trim().replace(/\s+/g," "),children:s});return e("div",{className:m,children:[e("div",{className:"flex items-center gap-2 "+("left"===c?"flex-row-reverse":""),children:[N,w]}),a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${p}\n        `.trim().replace(/\s+/g," "),children:a}),o&&!a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${h}\n        `.trim().replace(/\s+/g," "),children:o})]})});se.displayName="Checkbox";const ae=n(({checked:n=!1,onChange:r,name:s,value:a,label:o,error:l,helper:i,size:c="md",labelPosition:d="right",disabled:u=!1,className:m="",containerClassName:g="",labelClassName:p="",errorClassName:h="",helperClassName:f="",children:b,id:x,...y},v)=>{const N=x||`radio-${Math.random().toString(36).substr(2,9)}`,w=b||o,_=e("div",{className:"relative inline-flex items-center",children:[t("input",{ref:v,id:N,type:"radio",name:s,value:a,checked:n,onChange:e=>{r?.(e.target.value,e)},disabled:u,className:"sr-only",...y}),t("span",{className:`\n          flex-shrink-0 rounded-full flex items-center justify-center\n          border-2 transition-all duration-200\n          ${{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"}[c]}\n          ${n?l?"border-red-500 bg-red-500":"border-blue-600 bg-blue-600":l?"border-red-500":"border-gray-300 hover:border-blue-600"}\n          ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n          ${m}\n        `.trim().replace(/\s+/g," "),children:t("span",{className:`\n            rounded-full transition-all duration-200 bg-white\n            ${{sm:"w-1.5 h-1.5",md:"w-2.5 h-2.5",lg:"w-3 h-3"}[c]}\n            ${n?"opacity-100 scale-100":"opacity-0 scale-50"}\n          `.trim().replace(/\s+/g," ")})})]}),S=w&&t("label",{htmlFor:N,className:`\n        text-gray-700\n        text-xs sm:text-sm\n        font-normal\n        font-sans\n        whitespace-nowrap\n        select-none\n        ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n        ${p}\n      `.trim().replace(/\s+/g," "),children:w});return e("div",{className:g,children:[e("div",{className:"inline-flex items-center gap-2 "+("left"===d?"flex-row-reverse":""),children:[_,S]}),l&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${h}\n        `.trim().replace(/\s+/g," "),children:l}),i&&!l&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${f}\n        `.trim().replace(/\s+/g," "),children:i})]})});ae.displayName="Radio";const oe=n(({checked:n=!1,onChange:r,label:s,error:a,helper:o,size:l="md",labelPosition:i="right",onText:c,offText:d,disabled:u=!1,className:m="",containerClassName:g="",labelClassName:p="",errorClassName:h="",helperClassName:f="",id:b,...x},y)=>{const v=b||`switch-${Math.random().toString(36).substr(2,9)}`,N={sm:{track:"w-8 h-4",thumb:"w-3 h-3",translate:"translate-x-4",text:"text-xs px-1"},md:{track:"w-10 h-5",thumb:"w-4 h-4",translate:"translate-x-5",text:"text-xs px-1.5"},lg:{track:"w-12 h-6",thumb:"w-5 h-5",translate:"translate-x-6",text:"text-sm px-2"}}[l],w=`\n    relative inline-flex items-center\n    ${N.track}\n    rounded-full\n    transition-colors duration-200 ease-in-out\n    focus-within:outline-none\n    focus-within:ring-2\n    focus-within:ring-blue-500/20\n    ${n?a?"bg-red-500":"bg-blue-600":a?"bg-red-200":"bg-gray-300"}\n    ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n    ${m}\n  `.trim().replace(/\s+/g," "),_=`\n    inline-block\n    ${N.thumb}\n    bg-white\n    rounded-full\n    shadow\n    transform\n    transition-transform duration-200 ease-in-out\n    ${n?N.translate:"translate-x-0.5"}\n  `.trim().replace(/\s+/g," "),S=e("div",{className:"relative inline-flex",children:[t("input",{ref:y,id:v,type:"checkbox",checked:n,onChange:e=>{r?.(e.target.checked,e)},disabled:u,className:"sr-only",...x}),e("label",{htmlFor:v,className:w,children:[(c||d)&&t("span",{className:`\n            absolute inset-0 flex items-center justify-center\n            font-sans font-medium text-white\n            ${N.text}\n            pointer-events-none\n          `,children:n?c:d}),t("span",{className:_})]})]}),$=s&&t("label",{htmlFor:v,className:`\n        text-gray-700\n        text-xs sm:text-sm\n        font-normal\n        font-sans\n        select-none\n        ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n        ${p}\n      `.trim().replace(/\s+/g," "),children:s});return e("div",{className:g,children:[e("div",{className:"inline-flex items-center gap-3 "+("left"===i?"flex-row-reverse":""),children:[S,$]}),a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-red-500\n          font-sans\n          ${h}\n        `.trim().replace(/\s+/g," "),children:a}),o&&!a&&t("p",{className:`\n          mt-2\n          text-sm\n          text-gray-500\n          font-sans\n          ${f}\n        `.trim().replace(/\s+/g," "),children:o})]})});oe.displayName="Switch";const le=n(({label:n,error:s,helper:a,size:o="md",fullWidth:i=!1,autoResize:c=!1,minHeight:d=80,maxHeight:u=300,maxLength:m,showCount:g=!1,disabled:p=!1,required:h=!1,className:f="",containerClassName:b="",labelClassName:x="",errorClassName:y="",helperClassName:v="",countClassName:N="",value:w,onChange:_,id:S,...$},E)=>{const T=S||`textarea-${Math.random().toString(36).substr(2,9)}`,[C,k]=r(d),U=l(e=>{if(!c)return;e.style.height="auto";const t=e.scrollHeight,n=Math.min(Math.max(t,d),u);k(n),e.style.height=`${n}px`},[c,d,u]),O=`\n    \n    w-full\n    font-sans\n    text-gray-900\n    bg-white\n    border\n    rounded-lg\n    transition-all\n    duration-200\n    focus:outline-none\n    focus:ring-2\n    focus:ring-blue-500/20\n    disabled:opacity-50\n    disabled:cursor-not-allowed\n    disabled:bg-gray-50\n    resize-none\n  \n    ${{sm:"px-2 py-1.5 text-sm",md:"px-3 py-2 text-sm",lg:"px-4 py-3 text-base"}[o]}\n    ${s?"border-red-500 focus:border-red-500":"border-gray-300 focus:border-blue-500 hover:border-gray-400"}\n    ${c?"resize-none":"resize-y"}\n    ${f}\n  `.trim().replace(/\s+/g," "),I="string"==typeof w?w.length:0,R=!!m&&I>m;return e("div",{className:`${i?"w-full":"w-auto"} ${b}`,children:[e("div",{className:"flex justify-between items-center mb-2",children:[n&&t("label",{htmlFor:T,className:`\n              block\n              text-sm\n              font-medium\n              text-gray-700\n              font-sans\n              ${h?"after:content-['*'] after:text-red-500 after:ml-1":""}\n              ${p?"opacity-50":""}\n              ${x}\n            `.trim().replace(/\s+/g," "),children:n}),g&&(m||I>0)&&e("span",{className:`\n            text-sm\n            font-sans\n            ${R?"text-red-500":I/(m||100)>.8?"text-orange-500":"text-gray-500"}\n            ${N}\n          `.trim().replace(/\s+/g," "),children:[I,m&&`/${m}`]})]}),t("textarea",{ref:E,id:T,value:w,onChange:e=>{m&&e.target.value.length>m||(_?.(e),c&&U(e.target))},disabled:p,required:h,maxLength:m,className:O,style:c?{height:C,minHeight:d,maxHeight:u}:{minHeight:d},...$}),e("div",{className:"flex justify-between items-start mt-2",children:[e("div",{className:"flex-1",children:[s&&t("p",{className:`\n              text-sm\n              text-red-500\n              font-sans\n              ${y}\n            `.trim().replace(/\s+/g," "),children:s}),a&&!s&&t("p",{className:`\n              text-sm\n              text-gray-500\n              font-sans\n              ${v}\n            `.trim().replace(/\s+/g," "),children:a})]}),g&&!n&&(m||I>0)&&e("span",{className:`\n            text-sm\n            font-sans\n            ml-2\n            flex-shrink-0\n            ${R?"text-red-500":I/(m||100)>.8?"text-orange-500":"text-gray-500"}\n            ${N}\n          `.trim().replace(/\s+/g," "),children:[I,m&&`/${m}`]})]})]})});le.displayName="TextArea";const ie="1.0.2",ce="@team-semicolon/community-core";const de=function(){const e=i(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"sb-access-token",storage:{getItem:e=>{if("undefined"==typeof window)return null;try{const t=document.cookie.split("; ").find(t=>t.startsWith(`${e}=`))?.split("=")[1];if(!t)return null;const n=decodeURIComponent(t);try{const t=JSON.parse(n);t?.access_token&&import("@util/jwtUtil").then(({decodeJWTPayload:n,isTokenExpired:r,removeExpiredTokenFromCookie:s})=>{const a=n(t.access_token);a&&r(a)&&(console.log("🗑️ 클라이언트 Storage: 만료된 토큰 감지, 정리 중..."),s(e))})}catch(e){console.warn("클라이언트 Storage: 세션 데이터 파싱 실패:",e)}return n}catch(e){return console.error("❌ 클라이언트: 쿠키 읽기 실패:",e),null}},setItem:(e,t)=>{if("undefined"!=typeof window)try{if(!JSON.parse(t).access_token)return;const n=encodeURIComponent(t),r=new Date;r.setDate(r.getDate()+30),document.cookie=`${e}=${n}; expires=${r.toUTCString()}; path=/; SameSite=Lax; Secure`}catch(e){}},removeItem:e=>{if("undefined"!=typeof window)try{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}catch(e){}}}}});if("undefined"!=typeof window){let t=!1;e.auth.onAuthStateChange((n,r)=>{switch(n){case"SIGNED_OUT":t||(t=!0,e.auth.getSession().then(()=>{t=!1}));break;case"TOKEN_REFRESHED":break;case"USER_UPDATED":r||t||(t=!0,e.auth.signOut().then(()=>{t=!1}))}})}return e}();var ue=Object.freeze({__proto__:null,clientSupabase:de});export{te as Avatar,ee as Badge,Z as Button,se as Checkbox,ne as Input,ce as PACKAGE_NAME,ae as Radio,re as Select,oe as Switch,le as TextArea,K as Utils,ie as VERSION,u as formatDate,c as formatNumberWithComma,Q as getPackageConfig,Y as initializeCommunityCore,x as isAdmin,m as timeAgo};
//# sourceMappingURL=index.esm.js.map
